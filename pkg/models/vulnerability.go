package models

import (
	"time"
)

// Severity represents the severity level of a vulnerability
type Severity string

const (
	Critical Severity = "CRITICAL"
	High     Severity = "HIGH"
	Medium   Severity = "MEDIUM"
	Low      Severity = "LOW"
	Info     Severity = "INFO"
)

// Vulnerability represents a security vulnerability found during a scan
type Vulnerability struct {
	ID          string    `json:"id"`
	Name        string    `json:"name"`
	Description string    `json:"description"`
	Severity    Severity  `json:"severity"`
	CVEID       string    `json:"cve_id,omitempty"`
	CVSSScore   float64   `json:"cvss_score,omitempty"`
	Target      string    `json:"target"`
	Location    string    `json:"location"`
	Evidence    string    `json:"evidence,omitempty"`
	Remediation string    `json:"remediation,omitempty"`
	References  []string  `json:"references,omitempty"`
	Timestamp   time.Time `json:"timestamp"`
	Exploitable bool      `json:"exploitable"`
	Exploited   bool      `json:"exploited"`
	ExploitInfo string    `json:"exploit_info,omitempty"`
}

// ScanResult represents the results of a vulnerability scan
type ScanResult struct {
	Target          string          `json:"target"`
	ScanType        string          `json:"scan_type"`
	StartTime       time.Time       `json:"start_time"`
	EndTime         time.Time       `json:"end_time"`
	Duration        string          `json:"duration"`
	Vulnerabilities []Vulnerability `json:"vulnerabilities"`
	Summary         ResultSummary   `json:"summary"`
}

// ResultSummary provides a summary of the scan results
type ResultSummary struct {
	TotalVulnerabilities int `json:"total_vulnerabilities"`
	CriticalCount        int `json:"critical_count"`
	HighCount            int `json:"high_count"`
	MediumCount          int `json:"medium_count"`
	LowCount             int `json:"low_count"`
	InfoCount            int `json:"info_count"`
}

// ExploitResult represents the results of an exploitation attempt
type ExploitResult struct {
	Target          string          `json:"target"`
	ExploitType     string          `json:"exploit_type"`
	StartTime       time.Time       `json:"start_time"`
	EndTime         time.Time       `json:"end_time"`
	Duration        string          `json:"duration"`
	Vulnerabilities []Vulnerability `json:"vulnerabilities"`
	SuccessCount    int             `json:"success_count"`
	FailCount       int             `json:"fail_count"`
	SafeMode        bool            `json:"safe_mode"`
} 